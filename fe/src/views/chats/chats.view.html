<div class="panel" cg-busy="$ctrl.loadingPromise">
  <div class="chat-window">
    <!-- <div class="chat-header padding">
      <h3>{{ $ctrl.user.nombre_completo }} <small class="text-muted">{{ $ctrl.area.nombre }}</small></h3>
    </div> -->

    <div class="chat-history padding">
      <div class="message {{ msg.owner.id == $ctrl.self.id ? 'right' : 'left' }}" ng-repeat="msg in $ctrl.messages">
        <img class="img-responsive img-circle" style="visibility: {{ $ctrl.messages[$index-1].owner.id == $ctrl.messages[$index].owner.id ? 'hidden' : 'visible' }}" ng-src="{{ msg.owner.image | defaultImage }}">
        <h3 class="hug" ng-if="$ctrl.messages[$index-1].owner.id == $ctrl.messages[$index].owner.id ? false : true">{{ msg.owner.nombre_completo | available:'Yo' }}</h3>
        <p>
          <span ng-bind-html="msg.html"></span>
          <br>
          <small class="text-muted pull-right">
            <span ng-switch="msg.leido" ng-if="msg.owner.id == $ctrl.self.id">
              <span class="fa-stack" ng-switch-when="true">
                <i class="fa fa-fw fa-check fa-stack-1x" aria-hidden="true"></i>
                <i class="fa fa-fw fa-check fa-stack-1x" aria-hidden="true"></i>
              </span>
              <i class="fa fa-fw fa-check" ng-switch-when="false" aria-hidden="false"></i>
              <i class="fa fa-fw fa-clock-o" ng-switch-default aria-hidden="true"></i>
            </span>
            {{ msg.createdAt | date:'hh:mm a dd/MM/yyyy' }}
          </small>
        </p>
      </div>
    </div>

    <div class="chat-footer padding">
      <textarea ng-model="$ctrl.data.html" placeholder="Introduce tu mensaje aquÃ­.." ng-keydown="$ctrl.send($event)" autofocus></textarea>

      <div class="chat-buttons">
        <button class="btn btn-lg btn-primary"><i class="fa fa-fw fa-paper-plane-o" aria-hidden="true"></i></button>
      </div>
    </div>
  </div>
</div>